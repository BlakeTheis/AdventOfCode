test =""".......S.......
...............
.......^.......
...............
......^.^......
...............
.....^.^.^.....
...............
....^.^...^....
...............
...^.^...^.^...
...............
..^...^.....^..
...............
.^.^.^.^.^...^.
..............."""
real = """......................................................................S......................................................................
.............................................................................................................................................
......................................................................^......................................................................
.............................................................................................................................................
.....................................................................^.^.....................................................................
.............................................................................................................................................
....................................................................^...^....................................................................
.............................................................................................................................................
...................................................................^.^...^...................................................................
.............................................................................................................................................
..................................................................^.^.....^..................................................................
.............................................................................................................................................
.................................................................^.^.^.....^.................................................................
.............................................................................................................................................
................................................................^...^...^...^................................................................
.............................................................................................................................................
...............................................................^.^.^.^.....^.^...............................................................
.............................................................................................................................................
..............................................................^.^.^.^.^...^.^.^..............................................................
.............................................................................................................................................
.............................................................^.^.^.^.^.^...^.^.^.............................................................
.............................................................................................................................................
............................................................^.^.^.^.^.^.^...^...^............................................................
.............................................................................................................................................
...........................................................^.....^.^.^.^.^.^.^...^...........................................................
.............................................................................................................................................
..........................................................^...^.^.^.^.^.^.^.....^.^..........................................................
.............................................................................................................................................
.........................................................^.^.^.^.^.^.^.^.^.^.^.^...^.........................................................
.............................................................................................................................................
........................................................^.^...^.....^.^.^...^.^.^...^........................................................
.............................................................................................................................................
.......................................................^.^.^.^.^.^.^.^.......^.^.^.^.^.......................................................
.............................................................................................................................................
......................................................^.^.......^.^.....^...^.^.^.^.^.^......................................................
.............................................................................................................................................
.....................................................^.^...^.......^.^.^.^...^.^.^.^.^.^.....................................................
.............................................................................................................................................
....................................................^.^.^...^.^.^...^.^.^...^.......^.^.^....................................................
.............................................................................................................................................
...................................................^.^.^.^...^.^.^.^.^.^.....^.^.^.^.^...^...................................................
.............................................................................................................................................
..................................................^.^.^.^.^.^.^.^...^.^.^.^.........^.^...^..................................................
.............................................................................................................................................
.................................................^.....^.....^.^.^.......^.......^.....^...^.................................................
.............................................................................................................................................
................................................^.^.....^.^...^.^.^.^...^...^.....^.^...^.^.^................................................
.............................................................................................................................................
...............................................^.......^.^.......^.^.^.^...^.^.^.^...^.^.^.^.^...............................................
.............................................................................................................................................
..............................................^.^.^.^.^...........^.^.^.^.^.....^.^.^.^...^.^.^..............................................
.............................................................................................................................................
.............................................^...^.^.^.^.^.^.^.^...^...^.....^...^.^...^.^.^.^.^.............................................
.............................................................................................................................................
............................................^.^.......^.^.^.^...^.^...^.^.....^.^.^.^.^.^.^.^.^.^............................................
.............................................................................................................................................
...........................................^.^...^...^.^.^...^...^.^.^...^.^.^.^.^.^.^.^.......^.^...........................................
.............................................................................................................................................
..........................................^...^.^.^.^...^.^.^.^.....^.....^.^.^.^.^.^.^.^.^.^.....^..........................................
.............................................................................................................................................
.........................................^...^.^.^.^.^.^...^.^.^.^.^.^.^...^...^.^.^.^.^.^.^.^.^.^.^.........................................
.............................................................................................................................................
........................................^.^.^.^.^...^.^.^.^...^.....^.^...^.^...^...^.^.^...^...^.^.^........................................
.............................................................................................................................................
.......................................^.^...^.^.....^...^...^.^.^.^.^.^.^.^...^.^.^.^.^.^.^.^.^.....^.......................................
.............................................................................................................................................
......................................^.^.^.^.^.....^.....^.^.^...^.....^.^.^.^...^.^.^.^.^.^...^...^.^......................................
.............................................................................................................................................
.....................................^...^...^...........^.^.^.^.....^...^...^.^...^.^...^.^.^...^...^.^.....................................
.............................................................................................................................................
....................................^.^.^.^.^.^.^.^.....^.^.....^.^.^...^...^.^.^...^.^...^...^.^...^.^.^....................................
.............................................................................................................................................
...................................^.^.^.^.^...^.^.....^...^.^.^.^.^...^.^...^.......^.^.^.^.^.^.^.^.^.^.^...................................
.............................................................................................................................................
..................................^.^...^.^...^.^.^.^.^.^.^...^.^.^.....^.^.^.^.^...^.^.^.^...^.^.^.^...^.^..................................
.............................................................................................................................................
.................................^...^...^.^.^...^.^.^.^...^.^.^...^.^.....^.^.^.^.^.^.......^.^.^.^...^.^.^.................................
.............................................................................................................................................
................................^.^.^.^...^.^.....^.^...^...^.^.^.^.^.^.^.^...^.^.^.^.^.^...^.^...^.^.^.^.^.^................................
.............................................................................................................................................
...............................^.^.^.....^.^.^.^.^.^.^.^.^.^.^.^...^...^...^.....^...^.^...^.^.^.^.^.^.^.^.^.^...............................
.............................................................................................................................................
..............................^.^.^.^.^.^.^.^.^...^.....^.....^...^.^.^.^.^.^...^.^.^...^.^.^.^.^...^...^.^.^.^..............................
.............................................................................................................................................
.............................^.^.^.^.....^.....^...^.^.^.^...^.^.^...^.^.^.^.^.^.^.^.^.^...^.^...^.^.^.^.^.^...^.............................
.............................................................................................................................................
............................^.^...^.^.^.^.^...^.....^...^.....^.^.^.^...^.^.^.^.^...^.^...^.^.^...^.^.^.^.......^............................
.............................................................................................................................................
...........................^.^...^.^...^...^.^.^...^.^.^.^.^...^.^.^.......^.^...^.^.^.^.^...^.^.^.^.^.^.^.^.^.^.^...........................
.............................................................................................................................................
..........................^.^.^.^.^...^.^.^.^.^.^...^.^.....^.^.....^...^.^.^.^.^...^.^...^.^.^.^.^.^.^.^.^...^.^.^..........................
.............................................................................................................................................
.........................^.^...^...^.....^.^.^.^.^.....^.^...^.^.^...^.^.^...^.^.^.^.^...^...^...^.....^.^.^.^...^.^.........................
.............................................................................................................................................
........................^.^.^.....^.^.^.^.^...^...^.^.^.^.^.^.^.^.^.....^.^.^.^.^.^...^.^...^.^...^...^.^.^...^.^.^.^........................
.............................................................................................................................................
.......................^.....^.^.^...^.^.^.^.^.^.^.^.^...^.^...^...^.^.^.^...^...^.^.^.........^...^.^.^.^.^.^...^...^.......................
.............................................................................................................................................
......................^.^...^.^.^.......^.........^.^.^.....^.^.....^...^.^.^.^.....^.^...^.^.^.^.^.......^.....^.^...^......................
.............................................................................................................................................
.....................^.^.^...^.^.^.^.^.^.^.^.^.^...^...^...^.^.^.......^.......^...^.^.^.^.^.^...^...^.^.^.^.^.^.^.....^.....................
.............................................................................................................................................
....................^...^.......^.^.^...^.^.^.^.^.^.^.^.....^...^.^.^...^.^.^.....^.^...^.^.^.^...^.....^...^.......^...^....................
.............................................................................................................................................
...................^.^.^...^.^.^.^.^.^.^.^.^.......^.^.^.^.^.^.^.^.........^.....^...^.^.^...^.......^...^.^.^.......^...^...................
.............................................................................................................................................
..................^.....^.^.^.^.^.^...^.^.^.^.^.^.....^.^.^.^.^.^.^...^...^.^...^.^.^.^.^.^...^.^...^.^.^...^.^.^.^.^.^...^..................
.............................................................................................................................................
.................^.^.^.^.^.^.^.^.^.^.^...^...^.^.^.^.....^...^.^...^.^...^.^.^.^.^.....^.^...^.........^.^...^.....^.^.^...^.................
.............................................................................................................................................
................^.^.^.^.^...^...^.^...^.^.....^.^...^.^.^.^...^.^.^.^.^.^.^...^...^.^.^.^.....^.....^.^...^.^.^.^.^.^.^.^.^.^................
.............................................................................................................................................
...............^.....^...^.^.^.^...^.^...^...^.^.^.^.^.^...^.^.....^.^.^...^.^.^.^.^.^...^.^.....^.^...^.....^.^.......^.^.^.^...............
.............................................................................................................................................
..............^.^.^.^.....^.^.....^.^.^.^...^.^.^.^.^.^...^.^.^...^.^.^.^.^.^...^.^.^.^.^.^.^.^.^...^.....^.^.^.^.^.^.^...^.^.^..............
.............................................................................................................................................
.............^.^.....^...^.^.^.^.^...^.^.....^.^.^.....^...^.....^...^.^.^.^.^.^...^...^...^.^.......^.^...^.^.^.^.^.........^.^.............
.............................................................................................................................................
............^.^...^.^.^...^...^.^...^.^.^.^.....^.....^.^.....^.^...^.^.....^.^.^.........^.^.^.^.....^.^...^...^...^.^.....^.^.^............
.............................................................................................................................................
...........^.^.^.^.^.^...^.^.^.^.^.^.^...^.^.^.^.^.^.^...^...^.^...^.....^.^...^...^.^.^...^...^...^.....^.^.^.^.^.^.^.^.^...^.^.^...........
.............................................................................................................................................
..........^...^.^.^.^.^.....^.^.^.^.^.........^.^.......^.^.^.^...^.^...^.^.^.^.^.^.^...^.^...^.^.^...^.^...^.^.^.^.^.^...^...^.^.^..........
.............................................................................................................................................
.........^...^...^.^.^...^...........^...^.^.^.^.^.....^...^.^...^.^.^.^...^.^.^.^.^.^.^.^...^.^.^.^.^.^.^...^.^.^.^.^...^.^.^.^.^.^.........
.............................................................................................................................................
........^...^.^.^.^.^.^...^...^...^.^.....^.^.^.^.^.^.^.......^...^.^.^.^.^.^...^...^...^.^.^...^.^...^.......^.^.^.^.^.....^...^...^........
.............................................................................................................................................
.......^.^.^.....^.^.^.^.^.^.^...^.^.^.......^...^...^.^.^.^.^.^...^.^.^.^.^.^.^...^...^.^.^.^...^.^.^.^.^...^.^.^...^.^.^.^...^.....^.......
.............................................................................................................................................
......^.^...^.^.^.^.^.^.......^.^.^.^.^.^.^...^.^.^...^.^.^.^...^.^.^.^.....^...^.^.^.....^.^.^.^...^.^.^.^.....^.^.^...^...^...^...^.^......
.............................................................................................................................................
.....^.^.^.^.....^.^.^...^.....^...^...^.^...^.^.^.^.^...^.^.^...^...^.^.^.^.^.^.^...^.^.^.^.^.^...^...^.........^.^...^.^.^.^.^.^.^.^.^.....
.............................................................................................................................................
....^...^.....^.^.^...^...^.....^.^.^...^.^...^.^.^...^.^.^.....^...^...........^.^...^.^.^.^.^.^.^.....^.^.....^.^.^.^...^.^.^.^...^...^....
.............................................................................................................................................
...^.....^.^...^...^.^.^.^.^.^.^...^...^.^...^...^.^...^.^.^.^.^...^.....^.^.^.^.^.^...^.^.^.^...^.^.^.^.^.....^.^.^.^.....^.^.^.^.......^...
.............................................................................................................................................
..^.^.^...^...^.^...^...^.^.^.^...^.^.^...^...^.^.^.^.^.......^.^.^.^.^.^.......^.^.^.^...^.^.^.^...^.^.^.^.^.....^.^.^.....^.^...^.^.^.^.^..
.............................................................................................................................................
.^.^.^.....^.^.........^...^.^.......^...^.^.^...^.^.^.^.^.^.^.^.^.^.^.^.^...^.^.^...........^.^...^.^.^.^.^.^.......^.^.^.^.......^.^.^.^.^.
............................................................................................................................................."""

inp = real
inp = inp.split("\n")
total = 0
height = len(inp)
width = len(inp[0])
time = [[0 for i in range(width)] for j in range(height)]
# print(time)
def step(line):
    splits = 0
    for i in range(len(inp[line])):
        if inp[line][i] == "S":
            inp[line+1] = inp[line+1][:i] + "|" + inp[line+1][i+1:]
            time[line+1][i] += 1
        elif inp[line][i] == "|":
            if inp[line+1][i] == ".":
                inp[line+1] = inp[line+1][:i] + "|" + inp[line+1][i+1:]
                time[line+1][i] = time[line][i]
            elif inp[line+1][i] == "^":
                splits += 1
                inp[line+1] = inp[line+1][:i-1] + "|^|" + inp[line+1][i+2:]
                time[line+1][i-1] = time[line+1][i-1] + time[line][i]
                time[line+1][i+1] = time[line+1][i+1] + time[line][i] + time[line][i+1]
                
    return splits


for i in range(len(inp)-1):
    total += step(i)
    # print("\n".join(inp))
    # print(len(time))
    # for i in range(len(time)):
    #     for j in range(len(time[i])):
    #         print(time[i][j], end=" ")
    #     print()
    
print("\n".join(inp))
print(total)


total = 0
# time = [str(i) for i in time]
print(len(time))
for i in range(len(time)):
    for j in range(len(time[i])):
        if i == len(time)-1:
            total += time[i][j]
        print(time[i][j], end=" ")
    print()
print(total)











